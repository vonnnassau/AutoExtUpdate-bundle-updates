(function(p){typeof define=="function"&&define.amd?define(p):p()})(function(){"use strict";function p(e,n,o){this.menuItemLabel=e,this.enabled=n,this.checked=o}function _(e,n,o){this.menuItemID=e,this.enabled=n,this.checked=o}function t(){}t.THEME_COLOR_CHANGED_EVENT="com.adobe.csxs.events.ThemeColorChanged",t.prototype.hostEnvironment=window.__adobe_cep__?JSON.parse(window.__adobe_cep__.getHostEnvironment()):null,t.prototype.getHostEnvironment=function(){return this.hostEnvironment=JSON.parse(window.__adobe_cep__.getHostEnvironment()),this.hostEnvironment},t.prototype.loadBinAsync=function(e,n){try{var o=new XMLHttpRequest;o.responseType="arraybuffer",o.open("GET",e,!0),o.onerror=function(){return console.log("Unable to load snapshot from given URL"),!1},o.send(),o.onload=()=>{window.__adobe_cep__.loadSnapshot(o.response),typeof n=="function"?n():typeof n<"u"&&console.log("Provided callback is not a function")}}catch(i){return console.log(i),!1}return!0},t.prototype.loadBinSync=function(e){try{var n=this.getOSInformation();if(e.startsWith("file://"))return n.indexOf("Windows")>=0?e=e.replace("file:///",""):n.indexOf("Mac")>=0&&(e=e.replace("file://","")),window.__adobe_cep__.loadSnapshot(e),!0}catch(o){return console.log(o),!1}return!1},t.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()},t.prototype.getSystemPath=function(e){var n=decodeURI(window.__adobe_cep__.getSystemPath(e)),o=this.getOSInformation();return o.indexOf("Windows")>=0?n=n.replace("file:///",""):o.indexOf("Mac")>=0&&(n=n.replace("file://","")),n},t.prototype.evalScript=function(e,n){n==null&&(n=function(o){}),window.__adobe_cep__.evalScript(e,n)},t.prototype.getApplicationID=function(){var e=this.hostEnvironment.appId;return e},t.prototype.getHostCapabilities=function(){var e=JSON.parse(window.__adobe_cep__.getHostCapabilities());return e},t.prototype.dispatchEvent=function(e){typeof e.data=="object"&&(e.data=JSON.stringify(e.data)),window.__adobe_cep__.dispatchEvent(e)},t.prototype.addEventListener=function(e,n,o){window.__adobe_cep__.addEventListener(e,n,o)},t.prototype.removeEventListener=function(e,n,o){window.__adobe_cep__.removeEventListener(e,n,o)},t.prototype.requestOpenExtension=function(e,n){window.__adobe_cep__.requestOpenExtension(e,n)},t.prototype.getExtensions=function(e){var n=JSON.stringify(e),o=window.__adobe_cep__.getExtensions(n),i=JSON.parse(o);return i},t.prototype.getNetworkPreferences=function(){var e=window.__adobe_cep__.getNetworkPreferences(),n=JSON.parse(e);return n},t.prototype.initResourceBundle=function(){for(var e=JSON.parse(window.__adobe_cep__.initResourceBundle()),n=document.querySelectorAll("[data-locale]"),o=0;o<n.length;o++){var i=n[o],r=i.getAttribute("data-locale");if(r){for(var d in e)if(d.indexOf(r)===0){var c=e[d];if(d.length==r.length)i.innerHTML=c;else if(d.charAt(r.length)=="."){var S=d.substring(r.length+1);i[S]=c}}}}return e},t.prototype.dumpInstallationInfo=function(){return window.__adobe_cep__.dumpInstallationInfo()},t.prototype.getOSInformation=function(){var e=navigator.userAgent;if(navigator.platform=="Win32"||navigator.platform=="Windows"){var n="Windows",o="";return e.indexOf("Windows")>-1&&(e.indexOf("Windows NT 5.0")>-1?n="Windows 2000":e.indexOf("Windows NT 5.1")>-1?n="Windows XP":e.indexOf("Windows NT 5.2")>-1?n="Windows Server 2003":e.indexOf("Windows NT 6.0")>-1?n="Windows Vista":e.indexOf("Windows NT 6.1")>-1?n="Windows 7":e.indexOf("Windows NT 6.2")>-1?n="Windows 8":e.indexOf("Windows NT 6.3")>-1?n="Windows 8.1":e.indexOf("Windows NT 10")>-1&&(n="Windows 10"),e.indexOf("WOW64")>-1||e.indexOf("Win64")>-1?o=" 64-bit":o=" 32-bit"),n+o}else if(navigator.platform=="MacIntel"||navigator.platform=="Macintosh"){var i="Mac OS X";return e.indexOf("Mac OS X")>-1&&(i=e.substring(e.indexOf("Mac OS X"),e.indexOf(")")),i=i.replace(/_/g,".")),i}return"Unknown Operation System"},t.prototype.openURLInDefaultBrowser=function(e){return cep.util.openURLInDefaultBrowser(e)},t.prototype.getExtensionID=function(){return window.__adobe_cep__.getExtensionId()},t.prototype.getScaleFactor=function(){return window.__adobe_cep__.getScaleFactor()},navigator.appVersion.toLowerCase().indexOf("windows")>=0&&(t.prototype.getMonitorScaleFactor=function(){return window.__adobe_cep__.getMonitorScaleFactor()}),t.prototype.setScaleFactorChangedHandler=function(e){window.__adobe_cep__.setScaleFactorChangedHandler(e)},t.prototype.getCurrentApiVersion=function(){var e=JSON.parse(window.__adobe_cep__.getCurrentApiVersion());return e},t.prototype.setPanelFlyoutMenu=function(e){typeof e=="string"&&window.__adobe_cep__.invokeSync("setPanelFlyoutMenu",e)},t.prototype.updatePanelMenuItem=function(e,n,o){var i=!1;if(this.getHostCapabilities().EXTENDED_PANEL_MENU){var r=new p(e,n,o);i=window.__adobe_cep__.invokeSync("updatePanelMenuItem",JSON.stringify(r))}return i},t.prototype.setContextMenu=function(e,n){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenu",e,n)},t.prototype.setContextMenuByJSON=function(e,n){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenuByJSON",e,n)},t.prototype.updateContextMenuItem=function(e,n,o){var i=new _(e,n,o);ret=window.__adobe_cep__.invokeSync("updateContextMenuItem",JSON.stringify(i))},t.prototype.isWindowVisible=function(){return window.__adobe_cep__.invokeSync("isWindowVisible","")},t.prototype.resizeContent=function(e,n){window.__adobe_cep__.resizeContent(e,n)},t.prototype.registerInvalidCertificateCallback=function(e){return window.__adobe_cep__.registerInvalidCertificateCallback(e)},t.prototype.registerKeyEventsInterest=function(e){return window.__adobe_cep__.registerKeyEventsInterest(e)},t.prototype.setWindowTitle=function(e){window.__adobe_cep__.invokeSync("setWindowTitle",e)},t.prototype.getWindowTitle=function(){return window.__adobe_cep__.invokeSync("getWindowTitle","")},String.format=function(e){if(arguments.length===0)return null;var n=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(o,i){return n[i]})},typeof window.cep<"u"&&require("crypto"),typeof window.cep<"u"&&require("assert"),typeof window.cep<"u"&&require("buffer"),typeof window.cep<"u"&&require("child_process"),typeof window.cep<"u"&&require("cluster"),typeof window.cep<"u"&&require("dgram"),typeof window.cep<"u"&&require("dns"),typeof window.cep<"u"&&require("domain"),typeof window.cep<"u"&&require("events");const w=typeof window.cep<"u"?require("fs"):{};typeof window.cep<"u"&&require("http"),typeof window.cep<"u"&&require("https"),typeof window.cep<"u"&&require("net"),typeof window.cep<"u"&&require("os");const a=typeof window.cep<"u"?require("path"):{};typeof window.cep<"u"&&require("punycode"),typeof window.cep<"u"&&require("querystring"),typeof window.cep<"u"&&require("readline"),typeof window.cep<"u"&&require("stream"),typeof window.cep<"u"&&require("string_decoder"),typeof window.cep<"u"&&require("timers"),typeof window.cep<"u"&&require("tls"),typeof window.cep<"u"&&require("tty"),typeof window.cep<"u"&&require("url"),typeof window.cep<"u"&&require("util"),typeof window.cep<"u"&&require("v8"),typeof window.cep<"u"&&require("vm"),typeof window.cep<"u"&&require("zlib");const s=new t,l=s.getSystemPath("userData"),y=s.getExtensionID(),g=a.join(l,y),v=a.join(s.getSystemPath("extension"),"dist","app-bundle.umd.js"),u=a.join(g,"app-bundle.umd.js"),b=w.existsSync(u)?u:v,f=document.createElement("script");f.type="text/javascript",f.src="file://"+a.resolve(b),document.body.appendChild(f)});
